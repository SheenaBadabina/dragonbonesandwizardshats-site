<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>The Thief Who Destroyed Time (And Had to Fix It) • Dragon Bones & Wizards Hats</title>
  <meta name="description" content="The final story text rendered verbatim from its locked .txt asset." />
  <link rel="icon" href="/assets/Logodbwh.png" />
  <link rel="stylesheet" href="/assets/css/site.css" />
  <style>
    /* Lightweight page helpers to ensure readable layout even if CSS loads late */
    .wrap{max-width:980px;margin:0 auto;padding:20px}
    .hero img{width:100%;height:auto;border-radius:14px}
    .media{display:flex;gap:10px;flex-wrap:wrap;margin:14px 0 22px}
    .btn{display:inline-block;background:#1ee6c6;color:#031614;text-decoration:none;font-weight:700;padding:10px 14px;border-radius:12px}
    .muted{opacity:.75}
    .error{color:#ff8181;background:#2a1717;border:1px solid #5a2a2a;padding:12px;border-radius:10px}
    .prose p{margin:0 0 1em}
    .menu-btn{display:none}@media(max-width:760px){.menu-btn{display:inline-block}}
  </style>
</head>
<body>
  <!-- Site header -->
  <header class="site-header" style="border-bottom:1px solid #16222a;background:rgba(0,0,0,.35)">
    <div class="wrap" style="display:flex;align-items:center;gap:14px">
      <a class="brand" href="/" style="display:flex;align-items:center;gap:10px;text-decoration:none;color:inherit">
        <img src="/assets/Logodbwh.png" alt="" width="32" height="32" />
        <strong>Dragon Bones & Wizards Hats</strong>
      </a>
      <button class="menu-btn" id="hamburger" aria-label="Menu" aria-expanded="false" style="margin-left:auto;background:none;border:0;font-size:28px;color:inherit">☰</button>
      <nav id="site-nav" class="site-nav" aria-label="Primary" style="margin-left:auto;display:flex;gap:14px">
        <a href="/">Home</a>
        <a href="/stories/" aria-current="page">Stories</a>
        <a href="/work-with-me.html">Work With Me</a>
        <a href="/contact.html">Contact</a>
        <a href="/privacy-policy.html">Privacy</a>
        <a href="/terms-of-use.html">Terms</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <header class="hero" style="margin-top:18px">
      <h1>The Thief Who Destroyed Time (And Had to Fix It)</h1>
      <!-- Artwork with spaces/parentheses handled by encodeURI fallback -->
      <figure style="margin:12px 0 8px">
        <img
          id="cover"
          src="/assets/The Thief Who Destroyed Time (And Had to Fix It).png"
          alt="The Thief Who Destroyed Time — artwork"
          onerror="this.src=encodeURI('/assets/The Thief Who Destroyed Time (And Had to Fix It).png')"
          loading="eager" />
      </figure>
      <div class="media">
        <a class="btn" href="https://youtu.be/-i-ZGzN2j-E?si=Mm5Et7MM4sAIMn3V" target="_blank" rel="noopener">Watch on YouTube</a>
        <a class="btn" href="https://open.spotify.com/show/3piG2nuJ2M2xjwbQ7Eu8Df" target="_blank" rel="noopener">Listen on Spotify</a>
      </div>
      <p class="muted">Presented exactly as authored — pulled verbatim from the locked text asset.</p>
    </header>

    <!-- Story text rendered from immutable .txt -->
    <article id="story" class="prose">
      <p>Loading story…</p>
    </article>
    <div id="err" class="error" style="display:none"></div>
  </main>

  <footer style="border-top:1px solid #16222a;margin-top:28px">
    <div class="wrap" style="display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between">
      <p>© <span id="y"></span> dragonbonesandwizardshats</p>
      <p>
        <a href="/privacy-policy.html">Privacy Policy</a> •
        <a href="/terms-of-use.html">Terms of Use</a> •
        <a href="/contact.html">Contact</a>
      </p>
    </div>
  </footer>

  <script>
    // Mobile nav
    (function(){
      const btn = document.getElementById('hamburger');
      const nav = document.getElementById('site-nav');
      if(btn && nav){
        btn.addEventListener('click', ()=>{
          const open = nav.style.display !== 'none';
          nav.style.display = open ? 'none' : 'flex';
          btn.setAttribute('aria-expanded', String(!open));
        });
        if (window.matchMedia('(max-width:760px)').matches) nav.style.display='none';
      }
      document.getElementById('y').textContent = new Date().getFullYear();
    }());

    // Render plain text from immutable asset (verbatim)
    (async () => {
      const TXT = '/assets/stories/the-thief-who-destroyed-time.txt';
      const out = document.getElementById('story');
      const err = document.getElementById('err');

      try {
        const res = await fetch(TXT, { cache: 'no-store' });
        if (!res.ok) throw new Error('HTTP ' + res.status);
        const text = await res.text();

        // Escape HTML, convert paragraphs on blank lines, preserve in-line breaks.
        const html = text
          .split(/\r?\n\r?\n/g)
          .map(p => p
            .replace(/&/g,'&amp;')
            .replace(/</g,'&lt;')
            .replace(/>/g,'&gt;')
            .replace(/\r?\n/g,'<br>'))
          .map(p => `<p>${p}</p>`)
          .join('\n');

        out.innerHTML = html;
      } catch(e) {
        out.innerHTML = '';
        err.style.display = 'block';
        err.textContent = `Could not load story text from ${TXT}. ${e.message}`;
      }
    })();
  </script>
</body>
</html>
